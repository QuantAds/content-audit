#KEYWORD PAGE REPORT
SELECT 
    searchquery, 
    sum(impressions) as Impressions, 
    sum(clicks) as Clicks, 
    ifnull(round(sum(clicks)/sum(impressions)*100,2),0) as 'CTR(%)',
    round(sum(impressions)/(SELECT sum(impressions) FROM gsc.[customer])*100,1) AS 'Impression share',
    round(sum(clicks)/(SELECT sum(clicks) FROM gsc.[customer])*100,1) AS 'Click share',
    COUNT(DISTINCT(landingpage)) AS '# Landing pages',
    group_concat(DISTINCT(landingpage)) as 'Landing Page',
    ROUND(SUM(avgposition*impressions)/sum(impressions),1) AS 'Avg. rank',
    (searchquery LIKE "%[brand]%") AS brand
    #IF(ROUND(SUM(avgposition*impressions)/sum(impressions),1) <=100, sum(impressions)*(100-ROUND(SUM(avgposition*impressions)/sum(impressions),1)), 0) AS 'Visibility score'
    from gsc.[customer]
WHERE clientcountry = 'DK'
GROUP BY searchquery
#ORDER BY sum(impressions) DESC
LIMIT 0,1000
;
